---
title: 全栈的最后一公里
date: 2017-12-4 23:05
categories:
tags: [node,js]
toc: true
---

学完可以：

购买域名
了解如何购买服务器
如何在服务器安装node，mongodb
如何外网访问
如何部署项目到服务器
会配置nginx
熟练使用linux命令
会用DNSpod来管理你的DNS
将ip地址映射为你购买的域名
静态资源可以放到七牛云
配置https
将服务器和github上的代码关联起来


码云，免费的git私有仓库
> node权限访问学习

自己买的域名： xianyulaodi.top
[] 阿里云备案
邀请码： 1abqbf

自己买的云服务器：
用户名： root
密码： lac**20**?
操作系统：CentOS 7.2 64位 
公网/内网IP: 120.79.156.103 / 172.18.179.45  


参考文章：
把nodejs项目部署到阿里云： http://blog.csdn.net/chenlinIT/article/details/73343793
Nodejs 部署到阿里云全过程： http://blog.csdn.net/moumaobuchiyu/article/details/55004430
https://www.cnblogs.com/neromaycry/p/7072872.html 
LINUX中常用操作命令 http://www.daniubiji.cn/archives/25

我的node下载在: usr/src/
<!--more-->

## 生成环境所需要素

1. 购买自己的域名
2. 购买自己的服务器
3. 域名备案
4. 配置服务器应用环境
5. 安装配置数据库
6. 项目远程部署发布与更新

## 部署之路
IPtables Fail2Ban  安全措施
git 私有仓库
PM2

## 购买域名
1. 网站：爱名网、阿里云。阿里云比较好
.cn比较便宜
先不用买ssl证书

2. 主机选择：
尽量选大厂商，尽量选择国内的，阿里云不错

国外：
亚马逊
Linode

国内：
阿里云 ECS
青云/UCloud/百度云

阿里云 -> 产品 ->云服务器ECS
选择入门套餐，购买一年便宜
带宽： 自己玩，1M 够用
镜像： Ubuntu  64位  14.04 64位的
计费方式: 包年包月
地域: 随便选
实例: 默认 内存 1G，最低的选
云盘: 默认
设置密码: xxxx  root的登录密码


注册完： 

在阿里云首页进入控制台 
选择云服务器ECS
有任何问题：可以在阿里云上选择工单 ，提问问题


## 远程连接服务器

1. 域名备案
首次备案，域名不能访问
登录 - 控制台 -备案 - 服务号申请 - 去备案

## 登陆服务器地址

下载 Putty软件，百度
~ssh root@服务器ip  回车  然后输入密码

修改阿里云一些设置的时候，先选择停止

df -h这个命令很重要，查看一些盘的使用情况

#### 添加新用户

adduser xxx   回车，输入密码
添加权限 gpasswd -a xxname 


#### ssh无密码登陆服务器

window可能操作不一样，之前配置过github的无需再配置，否则可能覆盖掉


## 增强服务器安全等级

登陆服务默认端口为 22,需修改
设置防火墙： apt-get update 
pt-get upgrade
iptables -F
sudo iptables -F
vi/etc/

function xxx(a=xxx,b=xx) {
  let uploadInfo = {
     name: a
     itme: b
  }
  return uploadinfo
}
 

## 搭建node.js生产环境

安装一些东西：
apt-get install vim open 
ssl build-essential libassl-dev wget curl git

安装node
用nvm的方式

找到nvm上的安装脚本，粘贴进服务器，安装好后，用nvm安装node最新版本

nvm alias default v6.1.1

安装淘宝镜像 npm --registry=https://registry.npm.taobao.org install -g npm

echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p 

:wq!  保存命令行编辑


### 创建一个文件来测试一下：
vi app.js 编辑一个文件

esc 然后 :wq! 保存


外网不能访问： https://www.cnblogs.com/ericwen/p/3714847.html




***  视频教程看到第五章


## linux命令

[root@localhost ~]#

root 用户名
~ 当前所在位置
# 超级管理员  /root
$ 为普通用户 /home/name/

  pwd 显示当前所在位置


linux命令格式
【命令】 【选项】 【参数】

  -a 显示当前目录所有选项

  ls 后面可加命令

  ls -l 显示详细信息
  ls -lh 显示更人性化
  ls -a 显示所有文件，包括隐藏文件
  ls -d 查看目录属性
  ls -i 显示 inode

  文件类型 - 普通文件  d 目录文件  l 软链接文件

  目录文件处理命令：

  mkdir -p [目录名]  -p为递归创建，可选  比如 mkdir -p japan/canglaoshi  这样可以创建不存在的上一级目录

  cd ~ 回到当前用户家目录
  cd - 进入上次所在目录


删除空目录

rmdir [目录名]  删除空目录，少用

rm -rf [目录名] 删除非空目录

-r 删除目录
-f 强制删除

不要轻易用 -rf ，删了就没了

复制目录：
cp [选项] [源文件] [目标目录]

选项 

-r 复制目录
-p 连带文件属性复制  比如时间
-d 若源文件是链接文件，则复制链接属性
-a 相当于  -pdr

ll命令 ==  ls -l


剪切或改名命令
mv [源文件] [目标目录]


